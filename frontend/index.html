<html>
  <head> </head>
  <body>
    <script>
      var socket = new WebSocket("ws://localhost:8999");
      socket.onopen = function () {
        alert("Соединение установлено.");
      };

      socket.onclose = function (event) {
        if (event.wasClean) {
          alert("Соединение закрыто чисто");
        } else {
          alert("Обрыв соединения"); // например, "убит" процесс сервера
        }
        alert("Код: " + event.code + " причина: " + event.reason);
      };

      socket.onmessage = function (event) {
        let data = JSON.parse(event.data);
        console.log("Получены данные ", data);
      };

      socket.onerror = function (error) {
        alert("Ошибка " + error.message);
      };

      const register = async () => {
        await fetch("http://localhost:8999/register", {
          headers: { "Content-Type": "application/json" },
          method: "POST",
          body: JSON.stringify({ name: "htr" }),
        });

        socket.send(JSON.stringify({ type: "placeMe" }));
      };
    </script>
    <button onclick="register()">Зарегистрироваться</button>
  </body>
</html>
